<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Urbaneats - Campus Food Delivered</title>
  <link rel="shortcut icon" href="assets/img/logourbaneats.png" type="image/x-icon">
  <link rel="stylesheet" href="assets/css/styles.css" />
  <script>
    try {
      const u = localStorage.getItem('urbaneats_user');
      if (!u) {
        const next = encodeURIComponent('index.html');
        window.location.replace(`login.html?next=${next}`);
      }
    } catch (e) { /* ignore */ }
  </script>
</head>
<body>
  <script src="assets/js/loader.js"></script>
  <div id="page-loader" class="page-loader" aria-live="polite" aria-busy="true">
    <img src="assets/img/logourbaneats.png" alt="Urbaneats logo" />
    <p>Don't stress when we can help</p>
  </div>
  <section class="hero-bar">
    <div class="container hero-top">
      <a class="brand" href="index.html"><img src="assets/img/logourbaneats.png" alt="Urbaneats logo" class="brand-logo"></a>
      <div class="hero-actions" id="header-action"></div>
    </div>
    <div class="container hero-center">
      <h2 class="hero-title">Enter your address to know what's near you</h2>
      <form class="address-search" onsubmit="event.preventDefault(); window.location.href='menu.html';">
        <span class="icon" aria-hidden="true">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.5 14h-.79l-.28-.27a6.471 6.471 0 0 0 1.57-4.23 6.5 6.5 0 1 0-6.5 6.5c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l4.25 4.25c.41.41 1.09.41 1.5 0s.41-1.09 0-1.5L15.5 14Zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14Z" fill="currentColor"/>
          </svg>
        </span>
        <input id="address-input" class="input" placeholder="What's your address?" autocomplete="off" />
       <button class="btn btn-primary" aria-label="Search">→</button>
        <ul id="address-suggestions" class="suggestions" role="listbox" aria-label="Address suggestions"></ul>
      </form>
    </div>
  </section>

  <!-- <main class="container features-wrap">
    <h1 class="section-title">Anything delivered</h1>
    <section class="carousel" aria-roledescription="carousel">
      <div class="carousel-track">
        <article class="slide">
          <h3>Your city's top restaurants</h3>
          <p>With a great variety of restaurants you can order your favourite food or explore new restaurants nearby.</p>
        </article>
        <article class="slide">
          <h3>Fast delivery</h3>
          <p>Like a flash! Order or send anything in your city and receive it in minutes.</p>
        </article>
        <article class="slide">
          <h3>Groceries delivery & more</h3>
          <p>Find anything you need! From supermarkets to shops, pharmacies to florists — if it's in your city, order it and receive it.</p>
        </article>
      </div>
      <button class="carousel-btn prev" aria-label="Previous">‹</button>
      <button class="carousel-btn next" aria-label="Next">›</button>
      <div class="carousel-dots" role="tablist" aria-label="Carousel Pagination"></div>
    </section>
  </main> -->

  <footer class="site-footer">
    <div class="container footer-grid">
      <div>
        <a class="brand" href="/"><img src="assets/img/logourbaneats.png" alt="Urbaneats logo" class="brand-logo"></a>
        <p class="muted">Delicious food, delivered fast. Order from the best spots in town.</p>
      </div>
      <nav class="footer-col">
        <h4>Explore</h4>
        <a href="menu.html">Menu</a>
        <a href="#">Offers</a>
        <a href="#">About</a>
      </nav>
      <nav class="footer-col">
        <h4>Support</h4>
        <a href="#">Help Center</a>
        <a href="#">Privacy</a>
        <a href="store-admin.html">Terms</a>
        <a href="admin.html">Admin</a>
        <a href="courier-login.html">Become a courier</a>
      </nav>
      <div class="footer-col">
        <h4>Get in touch</h4>
        <p class="muted small">Email: urbaneats@example.com</p>
        <p class="muted small">Phone/WhatsApp: +234 8122861901</p>
      </div>
    </div>
    <div class="container footer-bottom">
      <p>© <span id="year"></span> Urbaneats</p>
    </div>
  </footer>

  <script type="module" src="assets/js/app.js"></script>
  <script type="module">
    import { getUserProfile } from './assets/js/auth.js';
    document.getElementById('year').textContent = new Date().getFullYear();
    // Loader hide on ready
    window.addEventListener('load', ()=>{
      const l = document.getElementById('page-loader');
      if (l) setTimeout(()=> l.classList.add('hide'), 200);
    });
    // Header action: login or profile icon (+ optional Store dashboard link for store admins)
    async function renderHeaderAction(){
      const wrap = document.getElementById('header-action');
      if (!wrap) return;
      let u=null; try{ u = JSON.parse(localStorage.getItem('urbaneats_user')||'null'); }catch{}
      if (!u){
        wrap.innerHTML = `<a class="btn login" href="login.html">Login</a>`;
      } else {
        const name = u.displayName || u.email || 'Account';
        let storeLink = '';
        try {
          const profile = await getUserProfile(u.uid);
          if (profile && profile.storeId) {
            storeLink = `<a class="btn btn-sm" href="store-admin.html" style="margin-right:8px">Store dashboard</a>`;
          }
        } catch {}
        wrap.innerHTML = `${storeLink}<a class="icon-btn" href="profile.html" title="${name}" aria-label="Profile">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z" fill="currentColor"/>
            <path d="M4 20.25A8.25 8.25 0 0 1 12.25 12h-.5A8.25 8.25 0 0 1 20 20.25c0 .966-.784 1.75-1.75 1.75H5.75A1.75 1.75 0 0 1 4 20.25Z" fill="currentColor"/>
          </svg>
        </a>`;
      }
    }
    renderHeaderAction();
    // Simple carousel logic
    const track = document.querySelector('.carousel-track');
    const slides = Array.from(document.querySelectorAll('.slide'));
    const prev = document.querySelector('.carousel-btn.prev');
    const next = document.querySelector('.carousel-btn.next');
    const dotsWrap = document.querySelector('.carousel-dots');
    let index = 0;
    let timer;

    function buildDots(){
      dotsWrap.innerHTML = slides.map((_,i)=>`<button class="dot" aria-label="Go to slide ${i+1}"></button>`).join('');
      dotsWrap.querySelectorAll('.dot').forEach((d,i)=> d.addEventListener('click', ()=> go(i)));
    }
    function update(){
      track.style.transform = `translateX(${-index*100}%)`;
      dotsWrap.querySelectorAll('.dot').forEach((d,i)=> d.classList.toggle('active', i===index));
    }
    function go(i){ index = (i+slides.length)%slides.length; update(); resetTimer(); }
    function nextSlide(){ go(index+1); }
    function resetTimer(){ clearInterval(timer); timer = setInterval(nextSlide, 5000); }

    prev.addEventListener('click', ()=> go(index-1));
    next.addEventListener('click', ()=> go(index+1));

    // swipe support
    let startX=null; track.addEventListener('touchstart', e=> startX=e.touches[0].clientX);
    track.addEventListener('touchend', e=>{ if(startX===null) return; const dx=e.changedTouches[0].clientX-startX; if(Math.abs(dx)>40) go(index + (dx<0?1:-1)); startX=null; });

    buildDots(); update(); resetTimer();

    // Address suggestions
    const SUGGESTIONS = [
      'emerald hall',
      'samuel akande hall',
      'nelson mandela hall',
      'busa',
      'busa hut',
      'sat',
      'crystal hall',
      'Sapphire hall',
      'lazz otti library',
      'BGH',
      'stadium',
      'Queen esther gazebo'
    ];
    const addrInput = document.getElementById('address-input');
    const list = document.getElementById('address-suggestions');
    let activeIndex = -1;

    function renderAddrList(values){
      list.innerHTML = values.map((v,i)=>{
        const firstSpace = v.indexOf(' ');
        const primary = firstSpace>0 ? v.slice(0, firstSpace) : v;
        const secondary = firstSpace>0 ? v.slice(firstSpace) : '';
        return `<li role="option" class="suggestion${i===activeIndex?' active':''}" data-value="${v.replace(/\"/g,'&quot;')}">
          <span class="primary">${primary}</span><span class="secondary">${secondary}</span>
        </li>`;
      }).join('');
      if (values.length) list.classList.add('show'); else list.classList.remove('show');
    }
    function filterAddr(q){
      const s = q.trim().toLowerCase();
      if (!s) return SUGGESTIONS;
      return SUGGESTIONS.filter(x => x.toLowerCase().includes(s));
    }
    function openList(){ activeIndex = -1; renderAddrList(filterAddr(addrInput.value)); }
    function closeList(){ list.classList.remove('show'); }
    function commit(value){
      addrInput.value = value;
      try { localStorage.setItem('urbaneats_address', value); } catch {}
      closeList();
    }

    addrInput.addEventListener('focus', openList);
    addrInput.addEventListener('input', ()=>{ activeIndex=-1; renderAddrList(filterAddr(addrInput.value)); });
    addrInput.addEventListener('keydown', (e)=>{
      const items = Array.from(list.querySelectorAll('.suggestion'));
      if (!items.length) return;
      if (e.key === 'ArrowDown'){ e.preventDefault(); activeIndex = (activeIndex+1)%items.length; items.forEach((el,i)=> el.classList.toggle('active', i===activeIndex)); }
      if (e.key === 'ArrowUp'){ e.preventDefault(); activeIndex = (activeIndex-1+items.length)%items.length; items.forEach((el,i)=> el.classList.toggle('active', i===activeIndex)); }
      if (e.key === 'Enter'){
        e.preventDefault();
        const pick = activeIndex>=0 ? items[activeIndex] : items[0];
        if (pick) commit(pick.dataset.value);
      }
      if (e.key === 'Escape'){ closeList(); }
    });
    list.addEventListener('click', (e)=>{
      const li = e.target.closest('li');
      if (!li) return;
      commit(li.dataset.value);
    });
    // hide on blur (small delay to allow click)
    addrInput.addEventListener('blur', ()=> setTimeout(closeList, 120));
    document.addEventListener('click', (e)=>{
      if (!document.querySelector('.address-search').contains(e.target)) closeList();
    });
  </script>
</body>
</html>
